<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ronnie‚Äôs RAID Extractor‚Ñ¢ | System & Flow</title>
  <meta name="description" content="Upload or paste a transcript, then instantly extract Risks, Actions, Issues, and Decisions with Ronnie‚Äôs RAID Extractor‚Ñ¢." />
  <meta name="theme-color" content="#0b1220" />
  <meta name="robots" content="index,follow" />

  <!-- Social -->
  <meta property="og:title" content="Ronnie‚Äôs RAID Extractor‚Ñ¢ | System & Flow" />
  <meta property="og:description" content="AI-powered RAID extraction for PMs ‚Äî Risks, Actions, Issues, and Decisions in seconds." />
  <meta property="og:image" content="https://systemnflow.com/assets/img/snf_logo.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png" />
  <link rel="manifest" href="/assets/img/site.webmanifest" />

  <!-- Styles -->
  <link rel="stylesheet" href="/styles.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
  <!-- üîπ Global Header -->
  <header class="site-header">
    <div class="container">
      <a href="/" class="brand-wrap" aria-label="System & Flow homepage">
        <img src="/assets/img/logo.png" alt="System & Flow logo" />
        <span class="brand">System & Flow</span>
      </a>
      <nav>
        <ul class="nav-links">
          <li><a href="/">Home</a></li>
          <li><a href="/apps.html">Tools</a></li>
          <li><a href="/contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- üîπ RAID Extractor Content -->
  <main class="container" style="max-width: 950px; margin: 4rem auto; padding: 2rem;">
    <h1 style="text-align:center; margin-bottom: 0.5rem;">Ronnie‚Äôs RAID Extractor‚Ñ¢</h1>
    <p style="text-align:center; color: var(--muted); margin-bottom: 2rem;">
      Paste or upload your transcript. Ronnie will extract <strong>‚ö†Ô∏è Risks</strong>, 
      <strong>‚úÖ Actions</strong>, <strong>üõë Issues</strong>, and <strong>üìå Decisions</strong> ‚Äî plus tags, owners, and confidence scores.
    </p>

    <!-- File Upload -->
    <input type="file" id="fileInput" accept=".txt,.docx,.pdf" style="margin-bottom:1rem;" />

    <!-- Paste Area -->
    <textarea 
      id="input" 
      rows="12" 
      placeholder="Paste transcript or upload a file..."
      style="width: 100%; padding: 1rem; border-radius: 10px; border: 1px solid var(--border); background: var(--panel); color: var(--ink);">
    </textarea>

    <!-- Actions -->
    <div style="margin-top: 1.5rem; display:flex; flex-wrap:wrap; gap:1rem;">
      <button id="run" class="button primary">Extract RAID</button>
      <button id="copy" class="button ghost">Copy to Clipboard</button>
      <button id="downloadCSV" class="button ghost">Export CSV</button>
      <button id="downloadExcel" class="button ghost">Export Excel</button>
      <button id="downloadPDF" class="button ghost">Export PDF</button>
    </div>

    <div id="output" style="margin-top: 2rem;"></div>
  </main>

  <!-- üîπ Global Footer -->
  <footer class="footer-min">
    <div class="container footer-container">
      <div class="foot-left">
        <img class="logo-icon" src="/assets/img/logo.png" alt="System & Flow logo icon" />
        <span class="brand">System & Flow</span>
        <span class="divider">‚Ä¢</span>
        <span class="tagline">Smarter tools. Faster PMs.</span>
      </div>
      <div class="foot-right">
        <a href="https://www.tiktok.com/@systemnflow" target="_blank">TikTok</a>
        <a href="https://www.instagram.com/systemnflow" target="_blank">Instagram</a>
        <a href="https://www.pinterest.com/systemnflow" target="_blank">Pinterest</a>
        <a href="https://www.youtube.com/@Systemnflow" target="_blank">YouTube</a>
        <a href="https://www.linkedin.com/company/systemnflow" target="_blank">LinkedIn</a>
        <a href="https://www.facebook.com/systemnflow" target="_blank">Facebook</a>
      </div>
    </div>
    <div class="legal">¬© <span id="y"></span> System & Flow‚Ñ¢. All rights reserved.</div>
  </footer>

  <!-- Script -->
  <script>
    document.getElementById("y").textContent = new Date().getFullYear();

    // üìù File Upload
    document.getElementById("fileInput").addEventListener("change", async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      if (file.type === "text/plain") {
        document.getElementById("input").value = await file.text();
      }
      else if (file.name.endsWith(".docx")) {
        const arrayBuffer = await file.arrayBuffer();
        const result = await mammoth.extractRawText({arrayBuffer});
        document.getElementById("input").value = result.value;
      }
      else if (file.type === "application/pdf") {
        const reader = new FileReader();
        reader.onload = async () => {
          const pdf = await pdfjsLib.getDocument({data: reader.result}).promise;
          let text = "";
          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const content = await page.getTextContent();
            text += content.items.map(it => it.str).join(" ") + "\n";
          }
          document.getElementById("input").value = text;
        };
        reader.readAsArrayBuffer(file);
      }
    });

    // üõ† RAID Extraction
    function analyze(text) {
      const risks = [], actions = [], issues = [], decisions = [], allRows = [];
      const urgencyWords = ["critical","urgent","high risk","immediate"];
      const names = ["Sarah","Mark","Ayana","Thomas","Janelle"];

      const lines = text.split("\n");
      lines.forEach(line => {
        const lower = line.toLowerCase();
        let confidence = Math.floor(Math.random()*20)+80; // fake 80-100%
        let owner = names.find(n => line.includes(n)) || "Unassigned";
        let urgency = urgencyWords.find(u => lower.includes(u)) ? "üö® High" : "";

        if (lower.includes("risk")) { risks.push({line,confidence,owner,urgency}); allRows.push({category:"Risk", item:line}); }
        else if (lower.includes("action") || lower.includes("will")) { actions.push({line,confidence,owner,urgency}); allRows.push({category:"Action", item:line}); }
        else if (lower.includes("issue") || lower.includes("problem")) { issues.push({line,confidence,owner,urgency}); allRows.push({category:"Issue", item:line}); }
        else if (lower.includes("decide") || lower.includes("decision") || lower.includes("agreed")) { decisions.push({line,confidence,owner,urgency}); allRows.push({category:"Decision", item:line}); }
      });
      return { risks, actions, issues, decisions, allRows };
    }

    function buildTable(data) {
      const cell = (arr,icon,label) => arr.map((o,i)=>
        `<div><strong>${icon} ${label} #${i+1}:</strong> ${o.line}<br>
         üë§ Owner: ${o.owner} ${o.urgency? "‚Ä¢ "+o.urgency:""}<br>
         ü§ñ Confidence: ${o.confidence}%</div><hr>`).join("") || "-";

      return `
        <table style="width:100%; border-collapse: collapse; margin-top: 1.5rem;">
          <thead>
            <tr style="background: var(--panel); color: var(--ink);">
              <th>Risks</th><th>Actions</th><th>Issues</th><th>Decisions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>${cell(data.risks,"‚ö†Ô∏è","Risk")}</td>
              <td>${cell(data.actions,"‚úÖ","Action")}</td>
              <td>${cell(data.issues,"üõë","Issue")}</td>
              <td>${cell(data.decisions,"üìå","Decision")}</td>
            </tr>
          </tbody>
        </table>
      `;
    }

    document.getElementById("run").addEventListener("click", () => {
      const text = document.getElementById("input").value.trim();
      if (!text) { document.getElementById("output").innerHTML = "<p>‚ö†Ô∏è Paste or upload something first.</p>"; return; }

      const result = analyze(text);
      document.getElementById("output").innerHTML = buildTable(result);

      // attach download/export
      document.getElementById("downloadCSV").onclick = () => exportCSV(result.allRows);
      document.getElementById("downloadExcel").onclick = () => exportExcel(result.allRows);
      document.getElementById("downloadPDF").onclick = () => exportPDF(result.allRows);
      document.getElementById("copy").onclick = () => copyToClipboard(buildTable(result));
    });

    // üìã Copy to Clipboard
    function copyToClipboard(html) {
      const blob = new Blob([html], {type: "text/html"});
      const data = [new ClipboardItem({ "text/html": blob })];
      navigator.clipboard.write(data);
      alert("‚úÖ RAID table copied to clipboard!");
    }

    // üìä CSV Export
    function exportCSV(rows) {
      let csv = "Category,Item\n";
      rows.forEach(r => csv += `"${r.category}","${r.item.replace(/"/g,'""')}"\n`);
      const blob = new Blob([csv], {type:"text/csv"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "raid-log.csv";
      a.click();
    }

    // üìä Excel Export
    function exportExcel(rows) {
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(rows);
      XLSX.utils.book_append_sheet(wb, ws, "RAID Log");
      XLSX.writeFile(wb, "raid-log.xlsx");
    }

    // üìë PDF Export
    function exportPDF(rows) {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text("System & Flow ‚Äî RAID Log", 14, 20);
      let y = 40;
      rows.forEach(r => {
        doc.text(`${r.category}: ${r.item}`, 14, y);
        y += 10;
      });
      doc.save("raid-log.pdf");
    }
  </script>
</body>
</html>
